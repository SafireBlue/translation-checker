// Reference: https://github.com/finnfiddle/words-to-numbers/blob/master/src/constants.js

export const Unit = {
    zero: 0,
    // tslint:disable-next-line:object-literal-sort-keys
    first: 1,
    one: 1,
    second: 2,
    two: 2,
    third: 3,
    thirteenth: 13,
    thirteen: 13,
    three: 3,
    fourth: 4,
    fourteenth: 14,
    fourteen: 14,
    four: 4,
    fifteenth: 15,
    fifteen: 15,
    fifth: 5,
    five: 5,
    sixth: 6,
    sixteenth: 16,
    sixteen: 16,
    six: 6,
    seventeenth: 17,
    seventeen: 17,
    seventh: 7,
    seven: 7,
    eighteenth: 18,
    eighteen: 18,
    eighth: 8,
    eight: 8,
    nineteenth: 19,
    nineteen: 19,
    ninth: 9,
    nine: 9,
    tenth: 10,
    ten: 10,
    eleventh: 11,
    eleven: 11,
    twelfth: 12,
    twelve: 12,
};

export const Ten = {
    twenty: 20,
    // tslint:disable-next-line:object-literal-sort-keys
    twentieth: 20,
    thirty: 30,
    thirtieth: 30,
    forty: 40,
    fortieth: 40,
    fifty: 50,
    fiftieth: 50,
    sixty: 60,
    sixtieth: 60,
    seventy: 70,
    seventieth: 70,
    eighty: 80,
    eightieth: 80,
    ninety: 90,
    ninetieth: 90,
};

export const Magnitude = {
    hundred: 100,
    hundredth: 100,
    thousand: 1000,
    // tslint:disable-next-line:object-literal-sort-keys
    million: 1000000,
    billion: 1000000000,
    trillion: 1000000000000,
    quadrillion: 1000000000000000,
    quintillion: 1000000000000000000,
    sextillion: 1000000000000000000000,
    septillion: 1000000000000000000000000,
    octillion: 1000000000000000000000000000,
    nonillion: 1000000000000000000000000000000,
    decillion: 1000000000000000000000000000000000,
};

// IMPORTANT: Sync with ULocalNumbersPattern
// Reference: http://cercopes-z.com/JavaScript/Object-Intl-NumberFormat-new-js.html
// Reference: http://www.asahi-net.or.jp/~ax2s-kmtn/ref/unicode/u2150.html
export const ULocalNumbers = {
    U0660: 0,
    U0661: 1,
    U0662: 2,
    U0663: 3,
    U0664: 4,
    U0665: 5,
    U0666: 6,
    U0667: 7,
    U0668: 8,
    U0669: 9,
    U06F0: 0,
    U06F1: 1,
    U06F2: 2,
    U06F3: 3,
    U06F4: 4,
    U06F5: 5,
    U06F6: 6,
    U06F7: 7,
    U06F8: 8,
    U06F9: 9,
    U1B50: 0,
    U1B51: 1,
    U1B52: 2,
    U1B53: 3,
    U1B54: 4,
    U1B55: 5,
    U1B56: 6,
    U1B57: 7,
    U1B58: 8,
    U1B59: 9,
    // tslint:disable-next-line:object-literal-sort-keys
    U09E6: 0,
    U09E7: 1,
    U09E8: 2,
    U09E9: 3,
    U09EA: 4,
    U09EB: 5,
    U09EC: 6,
    U09ED: 7,
    U09EE: 8,
    U09EF: 9,
    U0966: 0,
    U0967: 1,
    U0968: 2,
    U0969: 3,
    U096A: 4,
    U096B: 5,
    U096C: 6,
    U096D: 7,
    U096E: 8,
    U096F: 9,
    UFF10: 0,
    UFF11: 1,
    UFF12: 2,
    UFF13: 3,
    UFF14: 4,
    UFF15: 5,
    UFF16: 6,
    UFF17: 7,
    UFF18: 8,
    UFF19: 9,
    U0AE6: 0,
    U0AE7: 1,
    U0AE8: 2,
    U0AE9: 3,
    U0AEA: 4,
    U0AEB: 5,
    U0AEC: 6,
    U0AED: 7,
    U0AEE: 8,
    U0AEF: 9,
    U0A66: 0,
    U0A67: 1,
    U0A68: 2,
    U0A69: 3,
    U0A6A: 4,
    U0A6B: 5,
    U0A6C: 6,
    U0A6D: 7,
    U0A6E: 8,
    U0A6F: 9,
    U3007: 0,
    U4E00: 1,
    U4E8C: 2,
    U4E09: 3,
    U56DB: 4,
    U4E94: 5,
    U516D: 6,
    U4E03: 7,
    U516B: 8,
    U4E5D: 9,
    U17E0: 0,
    U17E1: 1,
    U17E2: 2,
    U17E3: 3,
    U17E4: 4,
    U17E5: 5,
    U17E6: 6,
    U17E7: 7,
    U17E8: 8,
    U17E9: 9,
    U0CE6: 0,
    U0CE7: 1,
    U0CE8: 2,
    U0CE9: 3,
    U0CEA: 4,
    U0CEB: 5,
    U0CEC: 6,
    U0CED: 7,
    U0CEE: 8,
    U0CEF: 9,
    U0ED0: 0,
    U0ED1: 1,
    U0ED2: 2,
    U0ED3: 3,
    U0ED4: 4,
    U0ED5: 5,
    U0ED6: 6,
    U0ED7: 7,
    U0ED8: 8,
    U0ED9: 9,
    U0030: 0,
    U0031: 1,
    U0032: 2,
    U0033: 3,
    U0034: 4,
    U0035: 5,
    U0036: 6,
    U0037: 7,
    U0038: 8,
    U0039: 9,
    U1946: 0,
    U1947: 1,
    U1948: 2,
    U1949: 3,
    U194A: 4,
    U194B: 5,
    U194C: 6,
    U194D: 7,
    U194E: 8,
    U194F: 9,
    U0D66: 0,
    U0D67: 1,
    U0D68: 2,
    U0D69: 3,
    U0D6A: 4,
    U0D6B: 5,
    U0D6C: 6,
    U0D6D: 7,
    U0D6E: 8,
    U0D6F: 9,
    U1810: 0,
    U1811: 1,
    U1812: 2,
    U1813: 3,
    U1814: 4,
    U1815: 5,
    U1816: 6,
    U1817: 7,
    U1818: 8,
    U1819: 9,
    U1040: 0,
    U1041: 1,
    U1042: 2,
    U1043: 3,
    U1044: 4,
    U1045: 5,
    U1046: 6,
    U1047: 7,
    U1048: 8,
    U1049: 9,
    U0B66: 0,
    U0B67: 1,
    U0B68: 2,
    U0B69: 3,
    U0B6A: 4,
    U0B6B: 5,
    U0B6C: 6,
    U0B6D: 7,
    U0B6E: 8,
    U0B6F: 9,
    U0BE6: 0,
    U0BE7: 1,
    U0BE8: 2,
    U0BE9: 3,
    U0BEA: 4,
    U0BEB: 5,
    U0BEC: 6,
    U0BED: 7,
    U0BEE: 8,
    U0BEF: 9,
    U0C66: 0,
    U0C67: 1,
    U0C68: 2,
    U0C69: 3,
    U0C6A: 4,
    U0C6B: 5,
    U0C6C: 6,
    U0C6D: 7,
    U0C6E: 8,
    U0C6F: 9,
    U0E50: 0,
    U0E51: 1,
    U0E52: 2,
    U0E53: 3,
    U0E54: 4,
    U0E55: 5,
    U0E56: 6,
    U0E57: 7,
    U0E58: 8,
    U0E59: 9,
    U0F20: 0,
    U0F21: 1,
    U0F22: 2,
    U0F23: 3,
    U0F24: 4,
    U0F25: 5,
    U0F26: 6,
    U0F27: 7,
    U0F28: 8,
    U0F29: 9,
    u2160: 1,
    u2161: 2,
    u2162: 3,
    u2163: 4,
    u2164: 5,
    u2165: 6,
    u2166: 7,
    u2167: 8,
    u2168: 9,
    u2169: 10,
    u216A: 11,
    u216B: 12,
    u2170: 1,
    u2171: 2,
    u2172: 3,
    u2173: 4,
    u2174: 5,
    u2175: 6,
    u2176: 7,
    u2177: 8,
    u2178: 9,
    u2179: 10,
    u217A: 11,
    u217B: 12,
};

// IMPORTANT: Sync with ULocalNumbers
// tslint:disable-next-line:max-line-length
export const ULocalNumbersPattern = "\u{0660}|\u{0661}|\u{0662}|\u{0663}|\u{0664}|\u{0665}|\u{0666}|\u{0667}|\u{0668}|\u{0669}|\u{06F0}|\u{06F1}|\u{06F2}|\u{06F3}|\u{06F4}|\u{06F5}|\u{06F6}|\u{06F7}|\u{06F8}|\u{06F9}|\u{1B50}|\u{1B51}|\u{1B52}|\u{1B53}|\u{1B54}|\u{1B55}|\u{1B56}|\u{1B57}|\u{1B58}|\u{1B59}|\u{09E6}|\u{09E7}|\u{09E8}|\u{09E9}|\u{09EA}|\u{09EB}|\u{09EC}|\u{09ED}|\u{09EE}|\u{09EF}|\u{0966}|\u{0967}|\u{0968}|\u{0969}|\u{096A}|\u{096B}|\u{096C}|\u{096D}|\u{096E}|\u{096F}|\u{FF10}|\u{FF11}|\u{FF12}|\u{FF13}|\u{FF14}|\u{FF15}|\u{FF16}|\u{FF17}|\u{FF18}|\u{FF19}|\u{0AE6}|\u{0AE7}|\u{0AE8}|\u{0AE9}|\u{0AEA}|\u{0AEB}|\u{0AEC}|\u{0AED}|\u{0AEE}|\u{0AEF}|\u{0A66}|\u{0A67}|\u{0A68}|\u{0A69}|\u{0A6A}|\u{0A6B}|\u{0A6C}|\u{0A6D}|\u{0A6E}|\u{0A6F}|\u{3007}|\u{4E00}|\u{4E8C}|\u{4E09}|\u{56DB}|\u{4E94}|\u{516D}|\u{4E03}|\u{516B}|\u{4E5D}|\u{17E0}|\u{17E1}|\u{17E2}|\u{17E3}|\u{17E4}|\u{17E5}|\u{17E6}|\u{17E7}|\u{17E8}|\u{17E9}|\u{0CE6}|\u{0CE7}|\u{0CE8}|\u{0CE9}|\u{0CEA}|\u{0CEB}|\u{0CEC}|\u{0CED}|\u{0CEE}|\u{0CEF}|\u{0ED0}|\u{0ED1}|\u{0ED2}|\u{0ED3}|\u{0ED4}|\u{0ED5}|\u{0ED6}|\u{0ED7}|\u{0ED8}|\u{0ED9}|\u{0030}|\u{0031}|\u{0032}|\u{0033}|\u{0034}|\u{0035}|\u{0036}|\u{0037}|\u{0038}|\u{0039}|\u{1946}|\u{1947}|\u{1948}|\u{1949}|\u{194A}|\u{194B}|\u{194C}|\u{194D}|\u{194E}|\u{194F}|\u{0D66}|\u{0D67}|\u{0D68}|\u{0D69}|\u{0D6A}|\u{0D6B}|\u{0D6C}|\u{0D6D}|\u{0D6E}|\u{0D6F}|\u{1810}|\u{1811}|\u{1812}|\u{1813}|\u{1814}|\u{1815}|\u{1816}|\u{1817}|\u{1818}|\u{1819}|\u{1040}|\u{1041}|\u{1042}|\u{1043}|\u{1044}|\u{1045}|\u{1046}|\u{1047}|\u{1048}|\u{1049}|\u{0B66}|\u{0B67}|\u{0B68}|\u{0B69}|\u{0B6A}|\u{0B6B}|\u{0B6C}|\u{0B6D}|\u{0B6E}|\u{0B6F}|\u{0BE6}|\u{0BE7}|\u{0BE8}|\u{0BE9}|\u{0BEA}|\u{0BEB}|\u{0BEC}|\u{0BED}|\u{0BEE}|\u{0BEF}|\u{0C66}|\u{0C67}|\u{0C68}|\u{0C69}|\u{0C6A}|\u{0C6B}|\u{0C6C}|\u{0C6D}|\u{0C6E}|\u{0C6F}|\u{0E50}|\u{0E51}|\u{0E52}|\u{0E53}|\u{0E54}|\u{0E55}|\u{0E56}|\u{0E57}|\u{0E58}|\u{0E59}|\u{0F20}|\u{0F21}|\u{0F22}|\u{0F23}|\u{0F24}|\u{0F25}|\u{0F26}|\u{0F27}|\u{0F28}|\u{0F29}|\u{2160}|\u{2160}|\u{2161}|\u{2162}|\u{2163}|\u{2164}|\u{2165}|\u{2166}|\u{2167}|\u{2168}|\u{2169}|\u{216A}|\u{216B}|\u{2170}|\u{2171}|\u{2172}|\u{2173}|\u{2174}|\u{2175}|\u{2176}|\u{2177}|\u{2178}|\u{2179}|\u{217A}|\u{217B}";

export const UnitKeys = Object.keys(Unit);
export const TenKeys = Object.keys(Ten);
export const MagnitudeKeys = Object.keys(Magnitude);
export const NumberWords = [ ...UnitKeys, ...TenKeys, ...MagnitudeKeys];

export class FoundResult {
    public StartIndex: number = -1;
    public Value: string = "";
}

export function FindD(text: string): FoundResult[] {
    const result = new Array<FoundResult>();
    const regex = RegExp(/\d+/g);
    let execResult: RegExpExecArray = regex.exec(text)!;
    while (execResult) {
        result.push({StartIndex: execResult.index, Value: execResult[0]});
        execResult = regex.exec(text)!;
    }
    return result;
}

export function FindEnglishNumberWords(text: string): FoundResult[] {
    const result = new Array<FoundResult>();
    const regex = RegExp(NumberWords.join("|"), "g");
    let execResult: RegExpExecArray = regex.exec(text)!;
    while (execResult) {
        result.push({StartIndex: execResult.index, Value: execResult[0]});
        execResult = regex.exec(text)!;
    }
    return result;
}

export function FindLocalNumbers(text: string): FoundResult[] {
    const result = new Array<FoundResult>();
    const regex = RegExp(ULocalNumbersPattern, "g");
    let execResult: RegExpExecArray = regex.exec(text)!;
    while (execResult) {
        result.push({StartIndex: execResult.index, Value: execResult[0]});
        execResult = regex.exec(text)!;
    }
    return result;
}

export default function(text: string): FoundResult[] {
    const result = new Array<FoundResult>();
    result.push(...FindD(text));
    result.push(...FindEnglishNumberWords(text));
    result.push(...FindLocalNumbers(text));
    result.sort((a, b) => a.StartIndex - b.StartIndex);
    return result;
}
